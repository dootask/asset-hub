description: 资产管理插件功能需求规划说明与约束（首页、系统管理、资产管理等）
globs: ["**/*"]
alwaysApply: false
---

## 功能需求规划总览

- 本插件围绕“资产全生命周期管理”，规划并已逐步落地首页概览、系统管理、资产管理、耗材管理（已完成首三阶段）以及版本信息展示等功能模块。

### 1. 首页

- 资产总览仪表板：实时展示资产总额、使用中、闲置、报废、待采购等指标。
- 资产分布统计：按资产类型或部门统计资产数量或价值，支持图表化展示。
- 快捷处理栏：提供审批中心、代办事项、帮助中心（用于查看更新通知等）入口。

### 2. 系统管理

- 公司管理：适用于集团公司或连锁门店等多公司场景，可添加/编辑/删除公司信息。
- 人员管理：**不在本插件中实现**，由 DooTask 主程序负责。本插件仅通过 `@dootask/tools` 获取用户身份信息以及发送相关通知，不维护人员数据和人员管理入口。
- 角色管理：
  - 系统角色：内置超级管理员、资产类型管理员（如固定资产管理员、设备管理员、无形资产管理员等）。
  - 审批中心配置：可自定义不同资产类型的审批流程，支持多级审批。
- 数据管理：
  - 报表统计：按操作人、操作类型（入库/领用/借用等）、操作内容（新增/删除等）、操作时间等维度生成报表，并可查看详情。
  - 自定义报表：预留扩展板块，可根据需要自定义报表字段和格式。
- 其他管理：
  - 操作管理：对各种操作进行管理，例如入库、出库、新增、删除、编辑、导入、导出等。
  - 升级管理：提供系统版本和用户数量的升级方案，绑定不同价位（价格/人数/年），包括版本有效期和续费操作。

### 3. 资产管理

- 资产设置：设定资产属性字段、状态值等基础配置。
- 资产列表：列出所有资产，支持筛选、分页和排序。
- 资产新增与批量导入：支持单条新增和批量导入，同时提供编辑、删除、筛选、批量导出功能。
- 分类管理：支持自定义资产类型（如公司固定资产、项目设备、无形资产）。
- 资产操作流程：
  - 采购：提交申请 → 审核 → 通过，支持审批意见。
  - 入库：支持上传多张资产照片（如至少三张不同角度），流程同样是提交 → 审核 → 通过。
  - 领用：员工领取资产的流程，提交申请后审批通过即可领取。
  - 借用/归还：允许借出并归还资产，借用逾期时需提醒（如对接 DooTask 代办系统），流程为提交 → 审核 → 通过。
  - 派发：用于资产分发，记录发货数量、日期、经办人、物流信息和费用等，流程同样是提交 → 审核 → 通过。
  - 其他操作：包括维修、报废处理、回收、遗失等，流程为提交 → 审核 → 通过。
- 资产盘点：支持创建盘点任务，设置盘点名称、选择资产类型、盘点时间及负责人，并提供数据下载。

### 4. 耗材管理（已上线能力与后续增强）

> 说明：耗材域已按「Phase 1–3」完成首期能力建设（详见仓库根目录 `consumables-module-status.md`），下面分为“已实现能力”与“后续可选增强”两部分描述。

**已实现能力（Phase 1–3）**

- 耗材设置与基础数据：
  - 已提供耗材类别与属性配置（如类别、计量单位、安全库存、保管人、存放位置等）。
  - 支持耗材列表、详情视图，按状态/类别/关键字筛选与分页。
- 耗材操作流程与库存联动：
  - 已实现采购、入库、出库 / 领用、预留 / 释放、调整、处理等操作类型，并通过服务端逻辑维护库存与预留数量，避免负库存。
  - 操作与审批打通：可根据配置决定是否对特定操作（如大额出库）发起审批，请求通过后才真正生效并影响库存。
  - 详情页内嵌操作时间线与操作表单，可查看单个耗材的完整变更历史。
- 盘点与告警：
  - 支持创建耗材盘点任务、生成盘点条目、记录系统数量与实盘数量以及差异说明，并维护任务状态（草稿 / 进行中 / 完成）。
  - 内置低库存 / 缺货告警，当库存低于安全库存或耗材耗尽时自动创建/更新告警记录；状态恢复正常时会自动关闭相关告警。
  - 告警可与 DooTask 待办联动：在宿主中创建“耗材告警”待办，并在告警关闭时同步关闭对应待办（若未配置宿主 API，则降级为本地日志）。
- 审计报表与导入导出：
  - 提供耗材操作审计视图，可按类型、状态、耗材、保管人、操作者、时间区间等维度筛选，并导出 CSV。
  - 支持耗材数据的导入与导出，便于批量初始化与外部系统对接。

**后续可选增强方向（不影响当前上线）**

- 出库策略与预算控制：在现有出库/处理操作基础上，增加成本字段、预算约束与供应商维度，形成“耗材成本概览”等管理报表。
- 更细粒度的告警策略：在系统管理中扩展告警配置（如按类别/地点控制是否告警、告警接收人等），在现有告警引擎之上做规则化配置。
- 与资产报表的统一视图：在报表中心中增加“耗材”维度切换，让管理员可以在同一报表页切换资产/耗材 KPI 与明细。

### 5. 突出展示

- 在系统主界面或个人中心突出显示当前版本号，方便用户感知当前使用的插件版本。

